/////////////////////////////////////////////////////////////////
#include "Transitions.h"
/////////////////////////////////////////////////////////////////

int AbstractTransition::_next_id = 0;

/////////////////////////////////////////////////////////////////

AbstractTransition::AbstractTransition() {
  id = _next_id;
  _next_id++;
}

/////////////////////////////////////////////////////////////////

void AbstractTransition::setGuardCondition(GuardCondition f) {
  guard_cb = f;
}

/////////////////////////////////////////////////////////////////

int AbstractTransition::getTransitionId() const {
  return transition_id;
}

/////////////////////////////////////////////////////////////////

void AbstractTransition::setTransitionId(int transitionId) {
  this->transition_id = transitionId;
}

/////////////////////////////////////////////////////////////////

void AbstractTransition::setOnRunHandler(CallbackFunction f) {
  on_run_cb = f;
}

/////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////
// Transition
/////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////

int Transition::getEventID() const {
  return event_id;
}

/////////////////////////////////////////////////////////////////

int Transition::getID() const {
  return id;
}

/////////////////////////////////////////////////////////////////

Transition::Transition() : event_id(0) {}

/////////////////////////////////////////////////////////////////

Transition::Transition(State* from, State* to, int event_id, int transitionId /* = "" */, CallbackFunction on_run /* = NULL */, GuardCondition guard /* = NULL */) {
  setup(from, to, event_id,transitionId, on_run, guard);
}

/////////////////////////////////////////////////////////////////

void Transition::setup(State* from, State* to, int event_id, int transitionId /* = "" */, CallbackFunction on_run /* = NULL */, GuardCondition guard /* = NULL */) {
  this->from = from;
  this->to = to;
  this->event_id = event_id;
  this->on_run_cb = on_run;
  this->transition_id = transition_id;
  this->guard_cb = guard;
}

/////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////
// TimedTransition
/////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////

TimedTransition::TimedTransition() : start(0), interval(0) {}

/////////////////////////////////////////////////////////////////

TimedTransition::TimedTransition(State* from, State* to, int interval, int transitionId /* = "" */, CallbackFunction on_run /* = NULL */, GuardCondition guard /* = NULL */) : TimedTransition() {
  setup(from, to, interval, transitionId,on_run, guard);
}

/////////////////////////////////////////////////////////////////

void TimedTransition::setup(State* from, State* to, int interval, int transitionId /* = "" */ ,CallbackFunction on_run /* = NULL */,GuardCondition guard /* = NULL */) {
  this->from = from;
  this->to = to;
  this->interval = interval;
  this->on_run_cb = on_run;
  this->transition_id = transitionId;
  this->guard_cb = guard;
}

/////////////////////////////////////////////////////////////////

int TimedTransition::getInterval() const {
  return interval;
}

/////////////////////////////////////////////////////////////////

int TimedTransition::getID() const {
  return id;
}

/////////////////////////////////////////////////////////////////

void TimedTransition::reset() {
  start = 0;
}

/////////////////////////////////////////////////////////////////